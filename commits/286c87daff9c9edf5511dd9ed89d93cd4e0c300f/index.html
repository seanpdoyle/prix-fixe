<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Use the title from a page's frontmatter if it has one -->
    <title>Execute the Rails-generated `bin/setup` script
</title>
    <link href="../../stylesheets/site.css" rel="stylesheet" />
    <link href="../../stylesheets/syntax.css" rel="stylesheet" />
    <script src="../../javascripts/site.js"></script>
  </head>
  <body class="page">
    <details id="table-of-contents" class="page__history" open>
      <summary class="page__history-summary">
        Table of Contents
      </summary>
      <nav class="history">
        <a href="../../">prix-fixe</a>

          <a href="../1106e13e2568ee68f1528e4ac3e42070ad24dfc6/">[GENERATED] Initial Commit
</a>
          <a href="../65bf913763168f594a3873bcd9d0f6577602c986/">Elaborate on the project&#x27;s goals in the README
</a>
          <a href="../6d1482de076a391b14b055aba66413577d326997/">Un-comment remaining `Gemfile` dependencies
</a>
          <a href="../63ad27b47bf372894689ee4a57193581d016bea6/">Create `git-read` GitHub Action
</a>
          <a href="./" aria-current="page">Execute the Rails-generated `bin&#x2F;setup` script
</a>
          <a href="../2e3dde3c9b976dfddaae6337c54d8a51fe2a3330/">Add `UserSharesAMessageTest`
</a>
          <a href="../c95a48404a071a14bc8fdeef8f51cd77754ae572/">Add a failing system test
</a>
          <a href="../838b705249321b89cf4927c3fc35fd6181cea17b/">Declare `GET &quot;&#x2F;&quot;` route
</a>
          <a href="../d3e4903047dbba9e787aa06c7bbe1a357f4bb5ae/">Declare `NotesController`
</a>
          <a href="../d8f2fe09296fac464175c9e06f23ff8816211187/">Extend from `ApplicationController`
</a>
          <a href="../a437fd15990afc70f4afff57532ac3c89628014f/">Declare `app&#x2F;views&#x2F;notes&#x2F;index.html.erb`
</a>
          <a href="../bcfa4308c498ef9f47a671cf8fbae1b02dc9419a/">Render `&lt;a&gt;` containing `&quot;Share a Note&quot;`
</a>
          <a href="../2f6d61d65f27dd2ca87ffa86581a8c22d6fc5af8/">Link to `&quot;&#x2F;&quot;`
</a>
          <a href="../d3f9e315cc244b767afb23ddbedabaf27cdc5239/">Declare `GET &#x2F;notes&#x2F;new` route
</a>
          <a href="../b64199c63d296c4900a8ac78410371a846f1e885/">Declare `app&#x2F;views&#x2F;notes&#x2F;new.html.erb` view
</a>
          <a href="../f0164b911d0955887a6c0033097e3a676a9c4c5c/">Render `&lt;label&gt;` and `&lt;textarea&gt;`
</a>
          <a href="../9e7fc11a58e9fffb2ec1d6180c9de0c0c892c107/">Render `&lt;button&gt;` in `notes#new` template
</a>
          <a href="../5798e2c774e69291b66afc50d463b6cbbd864c56/">Render `&lt;form&gt;` element in `notes#new` template
</a>
          <a href="../addf71a423212a4b11ddb43edc2b0561d3025763/">Declare a `POST &#x2F;notes` route
</a>
          <a href="../39a75e308d2e763b76d7ed5be5920f01629ffc71/">Declare `notes#create` view template
</a>
          <a href="../b8c0fecb78d00b574aee7e2c69925a839232d6c6/">Render content from `params`
</a>
          <a href="../1f63746b78e57188128bdd704116f09e94565551/">Add `name=&quot;content&quot;` to `&lt;textarea&gt;`
</a>
          <a href="../7ba2a35e86e64e8776362ffb7ec4cea1f85f1b6f/">Enable Request Forgery Protection in `test`
</a>
          <a href="../f5b15516c5af779de2ef17f44af4234954b6ea48/">Use `form_tag` instead of `&lt;form&gt;`
</a>
          <a href="../02b98cfd4c0c554ec15692331f1cdd7688f6df3f/">Render `&lt;form&gt;` with `form_tag` with `form_with`
</a>
          <a href="../8281c9086bcb597f699547d01d7cd0059f871caf/">Build `&lt;textarea&gt;` with `text_area` helper
</a>
          <a href="../5fdde2290a4d77da5147ecab7a754d2a5ed69852/">Replace `&lt;label&gt;` with `#label` invocation
</a>
          <a href="../174971072d0de3fb3994dec664ae61a5bef0b123/">Replace `&lt;button&gt;` with `#submit` invocation
</a>
          <a href="../252c588bd353f96fb510756cc218f3ba6fc849c4/">Use named route in `notes#index`
</a>
          <a href="../3ec5b4f8260c2456a169fd906d86bc9371425f65/">Replace `&quot;&#x2F;notes&quot;` with `notes_path` invocation
</a>
          <a href="../c4680e04ea80231440ac0ec04ffdef3686819f01/">Replace `post`, `get` declarations with `resources`
</a>
          <a href="../3608c1de14ecc0048809c216bc21bcfdf6f89dd4/">Rename `get &quot;&#x2F;&quot;` route to &quot;root&quot;
</a>
          <a href="../5a65273e39b91c524624d6aa47c54b44f9ea9379/">Replace `get &quot;&#x2F;&quot;` declaration with `root`
</a>
          <a href="../bf1d3997add65349a5556ef730d676474647943e/">Drive system tests with Headless Chrome Browser
</a>
          <a href="../eb4aca5aebbf9d6d74f912c57714a0189694ec9a/">Complete the first TDD Red-Green-Refactor Cycle
</a>
      </nav>
    </details>

    <main class="page__content">
      <header>

        <nav class="navigation">

<a href="../63ad27b47bf372894689ee4a57193581d016bea6/">              &#8592; Previous
</a>
<a href="../2e3dde3c9b976dfddaae6337c54d8a51fe2a3330/">              Next &#8594;
</a>        </nav>
      </header>

      <section class="container">
        <article class="container__item commit">
          <h1>Execute the Rails-generated <code>bin/setup</code> script</h1>

<p>After generating the new project&rsquo;s scaffolding, the first thing we&rsquo;ll do
is ensure that the application is executable.</p>

<p>Rails generates an executable <code>bin/setup</code> file that automates some of
the development environment configuration process, including:</p>

<ul>
<li>installing Ruby dependencies</li>
<li>ensuring that SQL databases exist</li>
<li>removing old <code>log/</code> and <code>tmp/</code> directories</li>
<li>restarting any running Rails servers</li>
</ul>

<p>This commit un-comments a Rails-generated line so that the script will
<em>also</em> install our project&rsquo;s JavaScript dependencies with
<a href="https://yarnpkg.com/en/"><code>yarn</code></a>.</p>

<p>When we execute <code>bin/setup</code> for the first time, an error is raised:</p>
<div class="highlight"><pre class="highlight plaintext"><code>== Installing dependencies ==
The dependency tzinfo-data (&gt;= 0) will be unused by any of the platforms Bundler is installing for. Bundler is installing for ru
by but the dependency is only for x86-mingw32, x86-mswin32, x64-mingw32, java. To add those platforms to the bundle, run `bundle
 lock --add-platform x86-mingw32 x86-mswin32 x64-mingw32 java`.
The Gemfile's dependencies are satisfied
yarn install v1.15.2
[1/4] üîç  Resolving packages...
[2/4] üöö  Fetching packages...
error @rails/webpacker@4.0.2: The engine "node" is incompatible with this module. Expected version "&gt;=6.14.4". Got "6.14.2"
error Found incompatible module
info Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.
</code></pre></div>
<p>For emphasis, the line of that error message that is most interesting:</p>
<div class="highlight"><pre class="highlight plaintext"><code>error @rails/webpacker@4.0.2: The engine "node" is incompatible with
  this module. Expected version "&gt;=6.14.4". Got "6.14.2"
</code></pre></div>
<p>By executing <code>rails new</code>, Rails has already generated a <code>.ruby-version</code>
file on our behalf.</p>

<p>Locally, we&rsquo;re using the <a href="https://asdf-vm.com"><code>asdf</code> Tool Version Manager</a> to ensure
that our the versions of our languages that this project depends on are
available.</p>

<p>Out-of-the-box, <a href="https://asdf-vm.com">ASDF</a> expects all dependencies to be declared in
the <code>.tool-versions</code> file, so this commit first renames <code>.ruby-version</code>
to <a href="#.tool-versions"><code>.tool-versions</code></a>.</p>

<p>To respond to the error raised by Webpacker, this commit extends that
<a href="#.tool-versions"><code>.tool-versions</code> file</a> to configure the <a href="https://github.com/asdf-vm/asdf-nodejs"><code>asdf-nodejs</code>
plugin</a>.</p>

<p>Our <a href="#.tool-versions"><code>.tool-versions</code> file</a> declares that the project
requires Node version <code>11.14.0</code>, which meets the <code>&quot;&gt;=6.14.4&quot;</code>
requirement.</p>

<p>By running <code>bin/setup</code> again, a new error is raised:</p>
<div class="highlight"><pre class="highlight plaintext"><code>== Preparing database ==
Created database 'db/development.sqlite3'
Created database 'db/test.sqlite3'
/Users/seanpdoyle/src/prix-fixe/db/schema.rb doesn't exist yet. Run `rails db:migrate` to create it, then try again. If you do $
ot intend to use a database, you should instead alter /Users/seanpdoyle/src/prix-fixe/config/application.rb to limit the framew$
rks that will be loaded.

== Command ["bin/rails db:setup"] failed ==
</code></pre></div>
<p>For emphasis, the most interesting part of the error message is:</p>
<div class="highlight"><pre class="highlight plaintext"><code>/Users/seanpdoyle/src/prix-fixe/db/schema.rb doesn't exist yet. Run
  `rails db:migrate` to create it, then try again.
</code></pre></div>
<p>To resolve this issue, run:</p>
<div class="highlight"><pre class="highlight shell"><code>% rails db:migrate
</code></pre></div>
<p>This commit includes the output of that command in the
<a href="#db/schema.rb"><code>db/schema.rb</code> file</a>.</p>

        </article>
          <aside class="container__item diff">
              <details
  id=".ruby-version"
  open
>
  <summary>
    .ruby-version
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/.ruby-version b/.ruby-version
</span><span class="p">deleted file mode 100644
</span><span class="gh">index d7edb56..0000000
</span><span class="gd">--- a/.ruby-version
</span><span class="gi">+++ /dev/null
</span><span class="p">@@ -1 +0,0 @@</span>
<span class="gd">-ruby-2.6.5
</span></code></pre></div></details>

              <details
  id=".tool-versions"
  open
>
  <summary>
    .tool-versions
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/.tool-versions b/.tool-versions
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..b137882
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/.tool-versions
</span><span class="p">@@ -0,0 +1,2 @@</span>
<span class="gi">+ruby 2.6.5
+nodejs 11.14.0
</span></code></pre></div></details>

              <details
  id="bin/setup"
  open
>
  <summary>
    bin/setup
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/bin/setup b/bin/setup
index 5853b5e..2d33af1 100755
</span><span class="gd">--- a/bin/setup
</span><span class="gi">+++ b/bin/setup
</span><span class="p">@@ -18,7 +18,7 @@</span> FileUtils.chdir APP_ROOT do
   system('bundle check') || system!('bundle install')
 
   # Install JavaScript dependencies
<span class="gd">-  # system('bin/yarn')
</span><span class="gi">+  system('bin/yarn')
</span> 
   # puts "\n== Copying sample files =="
   # unless File.exist?('config/database.yml')
</code></pre></div></details>

              <details
  id="db/schema.rb"
  open
>
  <summary>
    db/schema.rb
  </summary>

<div class="highlight"><pre class="highlight diff"><code><span class="gh">diff --git a/db/schema.rb b/db/schema.rb
</span><span class="p">new file mode 100644
</span><span class="gh">index 0000000..79b5c13
</span><span class="gd">--- /dev/null
</span><span class="gi">+++ b/db/schema.rb
</span><span class="p">@@ -0,0 +1,15 @@</span>
<span class="gi">+# This file is auto-generated from the current state of the database. Instead
+# of editing this file, please use the migrations feature of Active Record to
+# incrementally modify your database, and then regenerate this schema definition.
+#
+# This file is the source Rails uses to define your schema when running `rails
+# db:schema:load`. When creating a new database, `rails db:schema:load` tends to
+# be faster and is potentially less error prone than running all of your
+# migrations from scratch. Old migrations may fail to apply correctly if those
+# migrations use external dependencies or application code.
+#
+# It's strongly recommended that you check this file into your version control system.
+
+ActiveRecord::Schema.define(version: 0) do
+
+end
</span></code></pre></div></details>

          </aside>
      </section>
    </main>
  </body>
</html>
